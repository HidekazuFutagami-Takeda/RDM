<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="m_rdm_hco_mst">
	<resultMap id="mRdmHcoMstResultMap" type="jp.co.takeda.rdm.entity.join.MRdmHcoMstEntity">
		<result column="INS_NO" property="insNo"/>
		<result column="INS_CLASS" property="insClass"/>
		<result column="RELN_INS_NO" property="relnInsNo"/>
		<result column="RELN_INS_CODE" property="relnInsCode"/>
		<result column="INS_SBT" property="insSbt"/>
		<result column="INS_KANA" property="insKana"/>
		<result column="INS_KANA_SRCH" property="insKanaSrch"/>
		<result column="INS_ABBR_NAME" property="insAbbrName"/>
		<result column="INS_FORMAL_NAME" property="insFormalName"/>
		<result column="INS_CONT_NAME" property="insContName"/>
		<result column="INS_KANJ_SRCH" property="insKanjSrch"/>
		<result column="INS_PCODE" property="insPcode"/>
		<result column="ADDR_CODE_PREF" property="addrCodePref"/>
		<result column="ADDR_CODE_CITY" property="addrCodeCity"/>
		<result column="TK_CITY_CD" property="tkCityCd"/>
		<result column="INS_ADDR_DT" property="insAddrDt"/>
		<result column="INS_ADDR" property="insAddr"/>
		<result column="INS_ADDR_SRCH" property="insAddrSrch"/>
		<result column="INS_ADDR_KANA" property="insAddrKana"/>
		<result column="INS_ADDR_KANA_SRCH" property="insAddrKanaSrch"/>
		<result column="INS_PHONE1" property="insPhone1"/>
		<result column="INS_FAX1" property="insFax1"/>
		<result column="INS_PHONE2" property="insPhone2"/>
		<result column="INS_FAX2" property="insFax2"/>
		<result column="INS_PHONE_SRCH" property="insPhoneSrch"/>
		<result column="INS_URL" property="insUrl"/>
		<result column="INS_URL_YMD" property="insUrlYmd"/>
		<result column="TRADE_TYPE" property="tradeType"/>
		<result column="WS_TYPE" property="wsType"/>
		<result column="BASKET_PURCHASE" property="basketPurchase"/>
		<result column="HO_INS_TYPE" property="hoInsType"/>
		<result column="PHARM_TYPE" property="pharmType"/>
		<result column="INS_RANK" property="insRank"/>
		<result column="MANAGE_CD" property="manageCd"/>
		<result column="REG_VIS_TYPE" property="regVisType"/>
		<result column="IMP_HOS_TYPE" property="impHosType"/>
		<result column="IMP_INS_TYPE" property="impInsType"/>
		<result column="UNIV_SUBDIV" property="univSubdiv"/>
		<result column="INS_OPEN_YEAR" property="insOpenYear"/>
		<result column="INS_OPEN_MONTH" property="insOpenMonth"/>
		<result column="INS_OPEN_DAY" property="insOpenDay"/>
		<result column="HOS_EMERG" property="hosEmerg"/>
		<result column="CAPA_TYPE" property="capaType"/>
		<result column="BEDCNT_BASE" property="bedcntBase"/>
		<result column="BEDS_TOT" property="bedsTot"/>
		<result column="MED_BEDS_TOT" property="medBedsTot"/>
		<result column="ENTCAPA_NUM" property="entcapaNum"/>
		<result column="MAIN_INS_NO" property="mainInsNo"/>
		<result column="INS_SECOND_TYPE" property="insSecondType"/>
		<result column="ULT_INS_NO" property="ultInsNo"/>
		<result column="MDM_ID" property="mdmId"/>
		<result column="DEL_KBN" property="delKbn"/>
		<result column="DEL_REASON" property="delReason"/>
		<result column="DEL_REQ_YMD" property="delReqYmd"/>
		<result column="DEL_FLG" property="delFlg"/>
		<result column="DEL_YMD" property="delYmd"/>
		<result column="RST_REASON" property="rstReason"/>
		<result column="DUP_CODE" property="dupCode"/>
		<result column="DUP_UPDATE" property="dupUpdate"/>
		<result column="INS_SHA_YMD" property="insShaYmd"/>
		<result column="INS_SHA_ID" property="insShaId"/>
		<result column="UPD_SHA_YMD" property="updShaYmd"/>
		<result column="UPD_SHA_ID" property="updShaId"/>
	</resultMap>
	<resultMap id="nF211MainDataResultMap" type="jp.co.takeda.rdm.entity.join.SelectNF211MainDataEntity">
        <result column="REQ_ID" property="reqId"/>
        <result column="REQ_CHL" property="reqChl"/>
        <result column="SHN_SHZ" property="reqShzNm"/>
        <result column="REQ_STS_NM" property="reqStsNm"/>
        <result column="REQ_JGI_NAME" property="reqJgiName"/>
        <result column="REQ_YMDHMS" property="reqYmdhms"/>
        <result column="SHN_SHA_ID" property="shnShaName"/>
        <result column="SHN_YMDHMS" property="shnYmdhms"/>
        <result column="APR_SHA_ID" property="aprShaName"/>
        <result column="APR_YMDHMS" property="aprYmdhms"/>
        <result column="REQ_JGI_NO" property="reqJgiNo"/>
        <result column="REQ_BR_CODE" property="reqBrCd"/>
        <result column="REQ_DIST_CODE" property="reqDistCd"/>
        <result column="REQ_STS" property="reqStsCd"/>
        <result column="SHN_JGI_NO" property="shnJgiNo"/>
        <result column="APR_JGI_NO" property="aprJgiNo"/>
        <result column="UPD_SHA_YMD" property="updShaYmd"/>
        <result column="INS_NO" property="insNo"/>
        <result column="INS_ABBR_NAME" property="insAbbrName"/>
        <result column="INS_ADDR" property="insAddr"/>
        <result column="INS_SBT" property="insSbt"/>
        <result column="TRT_CD" property="trtCd"/>
        <result column="HIN_G_CD" property="hinGCd"/>
        <result column="TEKIYO_YMD" property="tekiyoYmd"/>
        <result column="MAIN_INS_NO" property="mainInsCd"/>
        <result column="MAIN_INS_NM" property="mainInsNm"/>
        <result column="MAIN_INS_ADDR" property="mainInsAddr"/>
        <result column="JGI_NAME" property="jgiName"/>
        <result column="MAIN_INS_SBT" property="mainInsSbt"/>
        <result column="INS_SBT_AF" property="insSbtAf"/>
        <result column="REQ_COMMENT" property="reqComment"/>
        <result column="APR_MEMO" property="aprMemo"/>
        <result column="SHN_FLG" property="shnFlg"/>
    </resultMap>
    <resultMap id="nF311MainDataResultMap" type="jp.co.takeda.rdm.entity.join.SelectNF311MainDataEntity">
        <result column="REQ_ID" property="reqId"/>
        <result column="SHN_SHZ" property="reqShzNm"/>
        <result column="REQ_STS_NM" property="reqStsNm"/>
        <result column="REQ_JGI_NAME" property="reqJgiName"/>
        <result column="REQ_YMDHMS" property="reqYmdhms"/>
        <result column="SHN_SHA_ID" property="shnShaName"/>
        <result column="SHN_YMDHMS" property="shnYmdhms"/>
        <result column="APR_SHA_ID" property="aprShaName"/>
        <result column="APR_YMDHMS" property="aprYmdhms"/>
        <result column="REQ_JGI_NO" property="reqJgiNo"/>
        <result column="REQ_BR_CODE" property="reqBrCd"/>
        <result column="REQ_DIST_CODE" property="reqDistCd"/>
        <result column="REQ_STS" property="reqStsCd"/>
        <result column="SHN_JGI_NO" property="shnJgiNo"/>
        <result column="APR_JGI_NO" property="aprJgiNo"/>
        <result column="UPD_SHA_YMD" property="updShaYmd"/>
        <result column="INS_NO" property="insNo"/>
        <result column="INS_ABBR_NAME" property="insAbbrName"/>
        <result column="INS_ADDR" property="insAddr"/>
        <result column="INS_SBT" property="insSbt"/>
        <result column="TRT_CD" property="trtCd"/>
        <result column="HIN_G_CD" property="hinGCd"/>
        <result column="TRT_PRD_GRP_NM" property="trtPrdGrpNm"/>
        <result column="TEKIYO_YMD" property="tekiyoYmd"/>
        <result column="MAIN_INS_NO" property="mainInsCd"/>
        <result column="MAIN_INS_NM" property="mainInsNm"/>
        <result column="MAIN_INS_ADDR" property="mainInsAddr"/>
        <result column="JGI_NAME" property="jgiName"/>
        <result column="MAIN_INS_SBT" property="mainInsSbt"/>
        <result column="INS_SBT_AF" property="insSbtAf"/>
        <result column="REQ_COMMENT" property="reqComment"/>
        <result column="APR_MEMO" property="aprMemo"/>
        <result column="APR_COMMENT" property="aprComment"/>
        <result column="SHN_FLG" property="shnFlg"/>
    </resultMap>
    <select id="selectByPK" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcoMstEntity" resultMap="mRdmHcoMstResultMap">
        SELECT
            INS_NO, INS_CLASS, RELN_INS_NO, RELN_INS_CODE, INS_SBT, INS_KANA, INS_KANA_SRCH, INS_ABBR_NAME, INS_FORMAL_NAME, INS_CONT_NAME, INS_KANJ_SRCH, INS_PCODE, ADDR_CODE_PREF, ADDR_CODE_CITY, TK_CITY_CD, INS_ADDR_DT, INS_ADDR, INS_ADDR_SRCH, INS_ADDR_KANA, INS_ADDR_KANA_SRCH, INS_PHONE1, INS_FAX1, INS_PHONE2, INS_FAX2, INS_PHONE_SRCH, INS_URL, INS_URL_YMD, TRADE_TYPE, WS_TYPE, BASKET_PURCHASE, HO_INS_TYPE, PHARM_TYPE, INS_RANK, MANAGE_CD, REG_VIS_TYPE, IMP_HOS_TYPE, IMP_INS_TYPE, UNIV_SUBDIV, INS_OPEN_YEAR, INS_OPEN_MONTH, INS_OPEN_DAY, HOS_EMERG, CAPA_TYPE, BEDCNT_BASE, BEDS_TOT, MED_BEDS_TOT, ENTCAPA_NUM, MAIN_INS_NO, INS_SECOND_TYPE, ULT_INS_NO, MDM_ID, DEL_KBN, DEL_REASON, DEL_REQ_YMD, DEL_FLG, DEL_YMD, RST_REASON, DUP_CODE, DUP_UPDATE, INS_SHA_YMD, INS_SHA_ID, UPD_SHA_YMD, UPD_SHA_ID
		FROM
            M_RDM_HCO_MST
        WHERE
            INS_NO = #{insNo}
    </select>
    <select id="selectNF211ReqTkdData" parameterType="jp.co.takeda.rdm.entity.join.SelectNF211MainDataEntity" resultMap="nF211MainDataResultMap">
		SELECT
		  KNR.REQ_ID  -- 申請管理.申請ID
		, KNR.REQ_CHL  -- 申請管理.申請チャネル
		, KNR.SHN_SHZ  -- 申請管理.申請者所属
		, CDM.VALUE1_KANJ AS REQ_STS_NM  -- 申請管理.申請ステータス
		, KNR.REQ_JGI_NAME  -- 申請管理.申請者氏名
		, KNR.REQ_YMDHMS  -- 申請管理.申請日時
		, KNR.SHN_SHA_ID  -- 申請管理.審査者氏名
		, KNR.SHN_YMDHMS  -- 申請管理.審査日時
		, KNR.APR_SHA_ID  -- 申請管理.承認者氏名
		, KNR.APR_YMDHMS  -- 申請管理.承認日時
		, KNR.REQ_JGI_NO  -- 申請管理.申請者従業員番号
		, KNR.REQ_BR_CODE  -- 申請管理.申請者所属リージョン
		, KNR.REQ_DIST_CODE  -- 申請管理.申請者所属エリア
		, KNR.REQ_STS  -- 申請管理.申請ステータス
		, KNR.SHN_JGI_NO  -- 申請管理.審査者従業員番号
		, KNR.APR_JGI_NO  -- 申請管理.承認者従業員番号
		, TO_CHAR(KNR.UPD_SHA_YMD,'YYYYMMDDhh24miss') AS UPD_SHA_YMD  -- 申請管理.更新日
		, NXT.INS_NO
		, MST_KO.INS_ABBR_NAME
		, MST_KO.INS_ADDR
		, MST_KO.INS_SBT
		, KNR.TEKIYO_YMD
		, NXT.MAIN_INS_NO_AF AS MAIN_INS_NO
		, MST_OYA.INS_ABBR_NAME AS MAIN_INS_NM
		, MST_OYA.INS_ADDR AS MAIN_INS_ADDR
		, MST_OYA.INS_SBT AS MAIN_INS_SBT
		, NXT.INS_SBT_AF
		, KNR.REQ_COMMENT  -- 申請管理.申請コメント
		, KNR.APR_MEMO  -- 申請管理.承認者メモ
		, KNR.SHN_FLG -- 申請管理.審査済みフラグ
		FROM
		T_RDM_REQ_KNR KNR -- 申請管理
		LEFT JOIN
		T_RDM_HCO_LNK_NXT_REQ NXT -- 武田紐親子_来期用_申請管理
		ON 1=1
		AND KNR.REQ_ID = NXT.REQ_ID
		LEFT JOIN
		M_RDM_HCO_MST MST_KO	-- 施設_基本情報 子
		ON 1=1
		AND MST_KO.INS_NO = NXT.INS_NO
		LEFT JOIN
		M_RDM_HCO_MST MST_OYA	-- 施設_基本情報 親
		ON 1=1
		AND MST_OYA.INS_NO = NXT.MAIN_INS_NO_AF
		LEFT JOIN
		M_RDM_CODE_MST CDM -- コード情報
		ON 1=1
		AND CDM.CODE_NAME = 'REQ_STS'
		AND CDM.DEL_FLG = '0'
		AND CDM.VALUE1 = KNR.REQ_STS
		WHERE 1=1
        AND KNR.REQ_ID = #{inReqId}
    </select>
    <select id="selectNF211ReqTrtData" parameterType="jp.co.takeda.rdm.entity.join.SelectNF211MainDataEntity" resultMap="nF211MainDataResultMap">
		SELECT
		  KNR.REQ_ID  -- 申請管理.申請ID
		, KNR.SHN_SHZ  -- 申請管理.申請者所属
		, CDM.VALUE1_KANJ AS REQ_STS_NM  -- 申請管理.申請ステータス
		, KNR.REQ_JGI_NAME  -- 申請管理.申請者氏名
		, KNR.REQ_YMDHMS  -- 申請管理.申請日時
		, KNR.SHN_SHA_ID  -- 申請管理.審査者氏名
		, KNR.SHN_YMDHMS  -- 申請管理.審査日時
		, KNR.APR_SHA_ID  -- 申請管理.承認者氏名
		, KNR.APR_YMDHMS  -- 申請管理.承認日時
		, KNR.REQ_JGI_NO  -- 申請管理.申請者従業員番号
		, KNR.REQ_BR_CODE  -- 申請管理.申請者所属リージョン
		, KNR.REQ_DIST_CODE  -- 申請管理.申請者所属エリア
		, KNR.REQ_STS  -- 申請管理.申請ステータス
		, KNR.SHN_JGI_NO  -- 申請管理.審査者従業員番号
		, KNR.APR_JGI_NO  -- 申請管理.承認者従業員番号
		, TO_CHAR(KNR.UPD_SHA_YMD,'YYYYMMDDhh24miss') AS UPD_SHA_YMD  -- 申請管理.更新日
		, LNK.INS_NO
		, MST_KO.INS_ABBR_NAME
		, MST_KO.INS_ADDR
		, MST_KO.INS_SBT
		, LNK.TRT_CD
		, LNK.HIN_G_CD
		, KNR.TEKIYO_YMD
		, LNK.MAIN_INS_NO_AF AS MAIN_INS_NO
		, MST_OYA.INS_ABBR_NAME AS MAIN_INS_NM
		, MST_OYA.INS_ADDR AS MAIN_INS_ADDR
		, MST_OYA.INS_SBT AS MAIN_INS_SBT
		, JGI.JGI_NAME
		, LNK.INS_SBT_AF
		, KNR.REQ_COMMENT  -- 申請管理.申請コメント
		, KNR.APR_MEMO  -- 申請管理.承認者メモ
		, KNR.SHN_FLG -- 申請管理.審査済みフラグ
		FROM
		T_RDM_REQ_KNR KNR -- 申請管理
		LEFT JOIN
		T_RDM_HCO_LNK_REQ LNK -- 領域品目グループ別親子_申請管理
		ON 1=1
		AND KNR.REQ_ID = LNK.REQ_ID
		LEFT JOIN
		M_RDM_HCO_MST MST_KO	-- 施設_基本情報 子
		ON 1=1
		AND MST_KO.INS_NO = LNK.INS_NO
		LEFT JOIN
		M_RDM_HCO_MST MST_OYA	-- 施設_基本情報 親
		ON 1=1
		AND MST_OYA.INS_NO = LNK.MAIN_INS_NO_AF
		LEFT JOIN
		M_RDM_JKR_MR_INS_TRT MR -- RDM用施設担当者情報
		ON 1=1
		AND MR.INS_NO = LNK.MAIN_INS_NO_AF
		AND MR.TRT_CD = LNK.TRT_CD
		LEFT JOIN
		M_RDM_JGI_SOS_MST JGI -- RDM用組織従業員情報
		ON 1=1
		AND JGI.JGI_NO = MR.JGI_NO
		LEFT JOIN
		M_RDM_CODE_MST CDM -- コード情報
		ON 1=1
		AND CDM.CODE_NAME = 'REQ_STS'
		AND CDM.DEL_FLG = '0'
		AND CDM.VALUE1 = KNR.REQ_STS
		WHERE 1=1
        AND KNR.REQ_ID = #{inReqId}
    </select>
    <select id="selectNF311ReqData" parameterType="jp.co.takeda.rdm.entity.join.SelectNF311MainDataEntity" resultMap="nF311MainDataResultMap">
		SELECT
		  KNR.REQ_ID  -- 申請管理.申請ID
		, KNR.REQ_CHL  -- 申請管理.申請チャネル
		, KNR.SHN_SHZ  -- 申請管理.申請者所属
		, CDM.VALUE1_KANJ AS REQ_STS_NM  -- 申請管理.申請ステータス
		, KNR.REQ_JGI_NAME  -- 申請管理.申請者氏名
		, KNR.REQ_YMDHMS  -- 申請管理.申請日時
		, KNR.SHN_SHA_ID  -- 申請管理.審査者氏名
		, KNR.SHN_YMDHMS  -- 申請管理.審査日時
		, KNR.APR_SHA_ID  -- 申請管理.承認者氏名
		, KNR.APR_YMDHMS  -- 申請管理.承認日時
		, KNR.REQ_JGI_NO  -- 申請管理.申請者従業員番号
		, KNR.REQ_BR_CODE  -- 申請管理.申請者所属リージョン
		, KNR.REQ_DIST_CODE  -- 申請管理.申請者所属エリア
		, KNR.REQ_STS  -- 申請管理.申請ステータス
		, KNR.SHN_JGI_NO  -- 申請管理.審査者従業員番号
		, KNR.APR_JGI_NO  -- 申請管理.承認者従業員番号
		, TO_CHAR(KNR.UPD_SHA_YMD,'YYYYMMDDhh24miss') AS UPD_SHA_YMD  -- 申請管理.更新日
		, LNK.INS_NO
		, MST_KO.INS_ABBR_NAME
		, MST_KO.INS_ADDR
		, MST_KO.INS_SBT
		, LNK.TRT_CD
		, LNK.HIN_G_CD
		, TRT.TRT_NM || '・' || PRD.HIN_G_NAME AS TRT_PRD_GRP_NM
		, KNR.TEKIYO_YMD
		, LNK.MAIN_INS_NO_AF AS MAIN_INS_NO
		, MST_OYA.INS_ABBR_NAME AS MAIN_INS_NM
		, MST_OYA.INS_ADDR AS MAIN_INS_ADDR
		, MST_OYA.INS_SBT AS MAIN_INS_SBT
		, JGI.JGI_NAME
		, LNK.INS_SBT_AF
		, KNR.REQ_COMMENT  -- 申請管理.申請コメント
		, KNR.APR_MEMO  -- 申請管理.承認者メモ
		, KNR.APR_COMMNET AS APR_COMMENT  -- 申請管理.承認・却下コメント
		, KNR.SHN_FLG -- 申請管理.審査済みフラグ
		FROM
		T_RDM_REQ_KNR KNR -- 申請管理
		LEFT JOIN
		T_RDM_HCO_LNK_REQ LNK -- 領域品目グループ別親子_申請管理
		ON 1=1
		AND KNR.REQ_ID = LNK.REQ_ID
		LEFT JOIN
		M_RDM_HCO_MST MST_KO	-- 施設_基本情報 子
		ON 1=1
		AND MST_KO.INS_NO = LNK.INS_NO
		LEFT JOIN
		M_RDM_HCO_MST MST_OYA	-- 施設_基本情報 親
		ON 1=1
		AND MST_OYA.INS_NO = LNK.MAIN_INS_NO_AF
		LEFT JOIN
		M_RDM_JKR_MR_INS_TRT MR -- RDM用施設担当者情報
		ON 1=1
		AND MR.INS_NO = LNK.MAIN_INS_NO_AF
		AND MR.TRT_CD = LNK.TRT_CD
		LEFT JOIN
		M_RDM_JGI_SOS_MST JGI -- RDM用組織従業員情報
		ON 1=1
		AND JGI.JGI_NO = MR.JGI_NO
		LEFT JOIN
		M_RDM_COM_CAL_USR CAL -- RDM用カレンダー(オンライン用)
		ON 1=1
		AND CAL.TODAY = '1'
		LEFT JOIN
		S_RDM_COM_LNK_TRT_PRDGRP_PRD PRD -- 領域別品目グループ品目
		ON 1=1
		AND PRD.TRT_CD = LNK.TRT_CD
		AND PRD.HIN_G_CD = LNK.HIN_G_CD
		AND PRD.TEKIYO_START_DATE <![CDATA[<=]]> CAL.CAL_DATE
		AND PRD.TEKIYO_END_DATE <![CDATA[>=]]> CAL.CAL_DATE
		LEFT JOIN
		S_RDM_COM_LNK_TRTGRP_TRT TRT -- 領域グループ・領域関連定義
		ON 1=1
		AND TRT.TRT_CD = PRD.TRT_CD
		AND TRT.TEKIYO_START_DATE <![CDATA[<=]]> CAL.CAL_DATE
		AND TRT.TEKIYO_END_DATE <![CDATA[>=]]> CAL.CAL_DATE
		LEFT JOIN
		M_RDM_CODE_MST CDM -- コード情報
		ON 1=1
		AND CDM.CODE_NAME = 'REQ_STS'
		AND CDM.DEL_FLG = '0'
		AND CDM.VALUE1 = KNR.REQ_STS
		WHERE 1=1
        AND KNR.REQ_ID = #{inReqId}
    </select>
</mapper>
