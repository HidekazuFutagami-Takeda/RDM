<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="m_rdm_hco_hcp_upd_hst">
    <resultMap id="MRdmHcpUpdHstEntiryResultMap" type="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity">

		<result column="DEPT_CODE" property="deptCode"/>
		<result column="DEPT_KJ" property="deptKj"/>

		<result column="INS_NO" property="insNo"/>
		<result column="INS_ABBR_NAME" property="insAbbrName"/>

        <result column="UPD_MST_YMD" property="updMstYmd"/>
        <result column="DOC_NO" property="docNo"/>
        <result column="DOC_TYPE" property="docType"/>
        <result column="DOC_TYPE_UPD_FLG" property="docTypeUpdFlg"/>
        <result column="DOC_KANJ" property="docKanj"/>
        <result column="DOC_KANJ_UPD_FLG" property="docKanjUpdFlg"/>
        <result column="DOC_KANA" property="docKana"/>
        <result column="DOC_KANA_UPD_FLG" property="docKanaUpdFlg"/>
        <result column="DOC_KANJ_SEI" property="docKanjSei"/>
        <result column="DOC_KANJ_SEI_UPD_FLG" property="docKanjSeiUpdFlg"/>
        <result column="DOC_KANJ_MEI" property="docKanjMei"/>
        <result column="DOC_KANJ_MEI_UPD_FLG" property="docKanjMeiUpdFlg"/>
        <result column="DOC_KANA_SEI" property="docKanaSei"/>
        <result column="DOC_KANA_SEI_UPD_FLG" property="docKanaSeiUpdFlg"/>
        <result column="DOC_KANA_MEI" property="docKanaMei"/>
        <result column="DOC_KANA_MEI_UPD_FLG" property="docKanaMeiUpdFlg"/>
        <result column="OLD_KANJ_SEI" property="oldKanjSei"/>
        <result column="OLD_KANJ_SEI_UPD_FLG" property="oldKanjSeiUpdFlg"/>
        <result column="OLD_KANA_SEI" property="oldKanaSei"/>
        <result column="OLD_KANA_SEI_UPD_FLG" property="oldKanaSeiUpdFlg"/>
        <result column="NEW_NAME_ST_YMD" property="newNameStYmd"/>
        <result column="NEW_NAME_ST_YMD_UPD_FLG" property="newNameStYmdUpdFlg"/>
        <result column="DOB_YMD" property="dobYmd"/>
        <result column="DOB_YMD_UPD_FLG" property="dobYmdUpdFlg"/>
        <result column="SEX" property="sex"/>
        <result column="SEX_UPD_FLG" property="sexUpdFlg"/>
        <result column="HOME_TOWN" property="homeTown"/>
        <result column="HOME_TOWN_UPD_FLG" property="homeTownUpdFlg"/>
        <result column="MED_SCH" property="medSch"/>
        <result column="MED_SCH_UPD_FLG" property="medSchUpdFlg"/>
        <result column="GRAD_YEAR" property="gradYear"/>
        <result column="GRAD_YEAR_UPD_FLG" property="gradYearUpdFlg"/>
        <result column="SSN_DEPT_CODE" property="ssnDeptCode"/>
        <result column="SSN_DEPT_CODE_UPD_FLG" property="ssnDeptCodeUpdFlg"/>
        <result column="H_UNIV" property="huniv"/>
        <result column="H_UNIV_UPD_FLG" property="hunivUpdFlg"/>
        <result column="EMPL_YEAR" property="emplYear"/>
        <result column="EMPL_YEAR_UPD_FLG" property="emplYearUpdFlg"/>
        <result column="SP_LIVER" property="spLiver"/>
        <result column="SP_LIVER_UPD_FLG" property="spLiverUpdFlg"/>
        <result column="SP_DISEASE" property="spDisease"/>
        <result column="SP_DISEASE_UPD_FLG" property="spDiseaseUpdFlg"/>
        <result column="SP_COM" property="spCom"/>
        <result column="SP_COM_UPD_FLG" property="spComUpdFlg"/>

        <result column="REQ_SHZ" property="reqShz"/>
        <result column="REQ_JGI_NAME" property="reqJgiName"/>
        <result column="APR_SHZ" property="aprShz"/>
        <result column="APR_SHA_ID" property="aprShaId"/>
        <result column="REQ_CHL" property="reqChl"/>
        <result column="REQ_ID" property="reqId"/>

        <result column="REQ_TYPE" property="reqType"/>
        <result column="INS_NO_SK" property="insNoSk"/>
        <result column="JOB_FORM_AF" property="jobFormAf"/>
        <result column="DEPT_KANJI_AF" property="deptKanjiAf"/>
        <result column="TITLE_CODE_AF" property="titleCodeAf"/>
        <result column="UNIV_POS_CODE_AF" property="univPosCodeAf"/>
        <result column="DCC_TYPE_AF" property="dccTypeAf"/>
        <result column="INS_NO_SK_UPD_FLG" property="insNoSkUpdFlg"/>
        <result column="JOB_FORM_AF_UPD_FLG" property="jobFormAfUpdFlg"/>
        <result column="DEPT_KANJI_AF_UPD_FLG" property="deptKanjiAfUpdFlg"/>
        <result column="TITLE_CODE_AF_UPD_FLG" property="titleCodeAfUpdFlg"/>
        <result column="UNIV_POS_CODE_AF_UPD_FLG" property="univPosCodeAfUpdFlg"/>
        <result column="DCC_TYPE_AF_UPD_FLG" property="dccTypeAfUpdFlg"/>
        <result column="INS_NO_MT" property="insNoMt"/>
        <result column="JOB_FORM_BF" property="jobFormBf"/>
        <result column="DEPT_KANJI_BF" property="deptKanjiBf"/>
        <result column="TITLE_CODE_BF" property="titleCodeBf"/>
        <result column="UNIV_POS_CODE_BF" property="univPosCodeBf"/>
        <result column="DCC_TYPE_BF" property="dccTypeBf"/>

        <result column="MEDICAL_SOCIETY_NM" property="medicalSocietyNm"/>
        <result column="MEDICAL_SOCIETY_NM_UPD_FLG" property="medicalSocietyNmUpdFlg"/>
        <result column="ADMISSION_YMD" property="admissionYmd"/>
        <result column="ADMISSION_YMD_UPD_FLG" property="admissionYmdUpdFlg"/>
        <result column="QUIT_YMD" property="quitYmd"/>
        <result column="QUIT_YMD_UPD_FLG" property="quitYmdUpdFlg"/>
        <result column="POSITION_CODE" property="positionCode"/>
        <result column="POSITION_CODE_UPD_FLG" property="positionCodeUpdFlg"/>
        <result column="SOCIETY_POSI_ST_YMD" property="societyPosiStYmd"/>
        <result column="SOCIETY_POSI_ST_YMD_UPD_FLG" property="societyPosiStYmdUpdFlg"/>
        <result column="SOCIETY_POSI_ED_YMD" property="societyPosiEdYmd"/>
        <result column="SOCIETY_POSI_ED_YMD_UPD_FLG" property="societyPosiEdYmdUpdFlg"/>
        <result column="COACHING_ACQUISI_YMD" property="coachingAcquisiYmd"/>
        <result column="COACHING_ACQUISI_YMD_UPD_FLG" property="coachingAcquisiYmdUpdFlg"/>
        <result column="COACHING_ST_YMD" property="coachinStYmd"/>
        <result column="COACHING_ST_YMD_UPD_FLG" property="coachinStYmdUpdFlg"/>
        <result column="COACHING_ED_YMD" property="coachinEdYmd"/>
        <result column="COACHING_ED_YMD_UPD_FLG" property="coachingEdYmdUpdFlg"/>
        <result column="CERTIFY_ST_YMD" property="certifyStYmd"/>
        <result column="CERTIFY_ST_YMD_UPD_FLG" property="certifyStYmdUpdFlg"/>
        <result column="CERTIFY_ED_YMD" property="certifyEdYmd"/>
        <result column="CERTIFY_ED_YMD_UPD_FLG" property="certifyEdYmdUpdFlg"/>
        <result column="ADVISING_DOCTOR" property="advisingDoctor"/>
        <result column="ADVISING_DOCTOR_UPD_FLG" property="advisingDoctorUpdFlg"/>
        <result column="CERTIFYING_PHYSICIAN" property="certifyingPhysician"/>
        <result column="CERTIFYING_PHYSICIAN_UPD_FLG" property="certifyingPhysicianUpdFlg"/>

        <result column="CLASS_CATEGORY" property="classCateGory"/>
        <result column="CLASS_CATEGORY_UPD_FLG" property="classCateGoryUpdFlg"/>
        <result column="PUB_INSTITUTION" property="pubInstitution"/>
        <result column="PUB_INSTITUTION_UPD_FLG" property="pubInstitutionUpdFlg"/>
        <result column="PUB_INST_ST_YMD" property="pubInstStYmd"/>
        <result column="PUB_INST_ST_YMD_UPD_FLG" property="pubInstStYmdUpdFlg"/>
        <result column="PUB_INST_ED_YMD" property="pubInstEdYmd"/>
        <result column="PUB_INST_ED_YMD_UPD_FLG" property="pubInstEdYmdUpdFlg"/>
        <result column="PUB_INST_POSITION" property="pubInstPosition"/>
        <result column="PUB_INST_POSITION_UPD_FLG" property="pubInstPositionUpdFlg"/>
        <result column="PUB_INSTPOS_ST_YMD" property="pubInstposStYmd"/>
        <result column="PUB_INSTPOS_ST_YMD_UPD_FLG" property="pubInstposStYmdUpdFlg"/>
        <result column="PUB_INSTPOS_ED_YMD" property="pubInstposEdYmd"/>
        <result column="PUB_INSTPOS_ED_YMD_UPD_FLG" property="pubInstposEdYmdUpdFlg"/>

    </resultMap>
    <resultMap id="SelectParamND501ResultMap" type="jp.co.takeda.rdm.entity.join.SelectParamND501Entity">
        <result column="PARAM_NAME" property="paramName"/>
        <result column="VALUE" property="value"/>
    </resultMap>

   <select id="selectParamND501" parameterType="jp.co.takeda.rdm.entity.join.SelectParamND501Entity" resultMap="SelectParamND501ResultMap">
        SELECT
            PARAM_NAME, VALUE
        FROM
            ORAUSR01.M_RDM_PARAM_MST
        WHERE
            PARAM_NAME in ('MAX_ROWNUM', 'ND501_ROWNUM')
        ORDER BY PARAM_NAME
    </select>

    <select id="selectShozokuBuka" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
        SELECT
			 DEPT_CODE,
			 DEPT_KJ
		FROM
			 M_RDM_HCP_SHOZOKU_BUKA
		WHERE
			DEPT_CODE = #{kensakuDeptCode}
    </select>

    <select id="selectInsAbbrName" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
        SELECT
			INS_NO,
			INS_ABBR_NAME
		FROM
			M_RDM_HCO_MST
		WHERE
			INS_NO = #{henkanInsNo}
    </select>

    <select id="searchUpdHst" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
	<!-- 医師基本情報 -->
	SELECT
		DISTINCT
		 UPD_HST.UPD_MST_YMD --マスタ更新日
		,UPD_HST.DOC_NO --医師固定コード
		,UPD_HST.DOC_TYPE --医師／薬剤師区分
		,UPD_HST.DOC_TYPE_UPD_FLG --医師／薬剤師区分更新フラグ
		,UPD_HST.DOC_KANJ --氏名（漢字）
		,UPD_HST.DOC_KANJ_UPD_FLG --氏名（漢字）更新フラグ
		,UPD_HST.DOC_KANA --氏名（カナ）
		,UPD_HST.DOC_KANA_UPD_FLG --氏名（カナ）更新フラグ
		,UPD_HST.DOC_KANJ_SEI --氏名（漢字）姓
		,UPD_HST.DOC_KANJ_SEI_UPD_FLG --氏名（漢字）姓更新フラグ
		,UPD_HST.DOC_KANJ_MEI --氏名（漢字）名
		,UPD_HST.DOC_KANJ_MEI_UPD_FLG --氏名（漢字）名更新フラグ
		,UPD_HST.DOC_KANA_SEI --氏名（カナ）姓
		,UPD_HST.DOC_KANA_SEI_UPD_FLG --氏名（カナ）姓更新フラグ
		,UPD_HST.DOC_KANA_MEI --氏名（カナ）名
		,UPD_HST.DOC_KANA_MEI_UPD_FLG --氏名（カナ）名更新フラグ
		,UPD_HST.OLD_KANJ_SEI --氏名（漢字）旧姓
		,UPD_HST.OLD_KANJ_SEI_UPD_FLG --氏名（漢字）旧姓更新フラグ
		,UPD_HST.OLD_KANA_SEI	--氏名（カナ）旧姓
		,UPD_HST.OLD_KANA_SEI_UPD_FLG	---氏名（カナ）旧姓更新フラグ
		,UPD_HST.NEW_NAME_ST_YYYY ||'/'|| UPD_HST.NEW_NAME_ST_MM ||'/'|| UPD_HST.NEW_NAME_ST_DD AS NEW_NAME_ST_YMD	--改姓日
		,UPD_HST.NEW_NAME_ST_YMD_UPD_FLG	--改姓日更新フラグ
		,UPD_HST.DOB_YYYY ||'/'|| UPD_HST.DOB_MM ||'/'|| UPD_HST.DOB_DD AS DOB_YMD --生年月日
		,UPD_HST.DOB_YMD_UPD_FLG	--生年月日更新フラグ
		,UPD_HST.SEX	--性別区分
		,UPD_HST.SEX_UPD_FLG	--性別区分更新フラグ
		,UPD_HST.HOME_TOWN	--出身地コード
		,UPD_HST.HOME_TOWN_UPD_FLG	--出身地コード更新フラグ
		,UPD_HST.MED_SCH	--出身校コード
		,UPD_HST.MED_SCH_UPD_FLG	--出身校コード更新フラグ
		,UPD_HST.GRAD_YEAR	--卒年
		,UPD_HST.GRAD_YEAR_UPD_FLG	--卒年更新フラグ
		,UPD_HST.SSN_DEPT_CODE	--出身所属コード
		,UPD_HST.SSN_DEPT_CODE_UPD_FLG	--出身所属コード更新フラグ
		,UPD_HST.H_UNIV --出身医局校コード
		,UPD_HST.H_UNIV_UPD_FLG --出身医局校コード更新フラグ
		,UPD_HST.EMPL_YEAR	--臨床研修年
		,UPD_HST.EMPL_YEAR_UPD_FLG	--臨床研修年更新フラグ
		,UPD_HST.SP_LIVER	--専門臓器コード
		,UPD_HST.SP_LIVER_UPD_FLG	--専門臓器コード更新フラグ
		,UPD_HST.SP_DISEASE	--専門詳細コード
		,UPD_HST.SP_DISEASE_UPD_FLG	--専門詳細コード更新フラグ
		,UPD_HST.SP_COM	--専門追加情報
		,UPD_HST.SP_COM_UPD_FLG	--専門追加情報更新フラグ
		,UPD_HST.REQ_SHZ	--申請者所属
		,UPD_HST.REQ_JGI_NAME	--申請者氏名
		,UPD_HST.APR_SHZ	--承認者所属
		,UPD_HST.APR_SHA_ID	--承認者氏名
		,UPD_HST.REQ_CHL	--申請チャネル
		,UPD_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_UPD_HST UPD_HST --医師_変更履歴
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = UPD_HST.DOC_NO --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCP_WORK HCP_WORK --医師_勤務先情報
	ON
		HCP_WORK.DOC_NO = UPD_HST.DOC_NO --医師固定コード
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST --施設_基本情報
	ON
		HCO_MST.INS_NO = HCP_WORK.INS_NO --施設固定コード
	<where>
		<if test="jokenSetCd == 0">
			<if test="mrJgiNo != 0">
			AND
				DOC_TRT.JGI_NO = #{mrJgiNo}
			</if>
			<if test="mrTrtCd != null">
			AND
				DOC_TRT.TRT_CD = #{mrTrtCd}
			</if>
			<if test="mrJgiNo != 0">
			AND
				UPD_HST.REQ_JGI_NO = #{mrJgiNo}
			</if>
			<if test="mrDistCode != null">
			AND
				UPD_HST.REQ_DIST_CODE = #{mrDistCode}
			</if>
			<if test="mrBrCode != null">
			AND
				UPD_HST.REQ_BR_CODE = #{mrBrCode}
			</if>
		</if>

		<if test="jokenSetCd == 1">
			<if test="kensakuTantouDistCode != null">
			AND
				SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
			</if>
			<if test="kensakuSTantouBrCode != null">
			AND
				SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
			</if>
			<if test="kensakuJgiNo != 0">
			AND
				DOC_TRT.JGI_NO = #{kensakuJgiNo}
			</if>
			<if test="kensakuShinseiBrCode != null">
			AND
				UPD_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
			</if>
			<if test="kensakuShinseiDistCode != null">
			AND
				UPD_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
			</if>
			<if test="kensakuReqJgiName != null">
			AND
				UPD_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
			</if>
		</if>

		<if test="kensakuDocKanj != null">
		AND
			UPD_HST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
		</if>
		<if test="kensakuDocKana != null">
		AND
			UPD_HST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
		</if>
		<if test="kensakuDocNo != null">
		AND
			UPD_HST.DOC_NO = #{kensakuDocNo}
		</if>
		<if test="kensakuUltDocNo != null">
		AND
			UPD_HST.ULT_DOC_NO = #{kensakuUltDocNo}
		</if>
		<if test="kensakuDocType != null">
		AND
			UPD_HST.DOC_TYPE = #{kensakuDocType}
		</if>
		<if test="kensakuDocAttribute != null">
		AND
			UPD_HST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
		</if>
		<if test="kensakuGradYear != null">
		AND
			UPD_HST.GRAD_YEAR = #{kensakuGradYear}
		</if>
		<if test="kensakuMedSch != null">
		AND
			UPD_HST.MED_SCH = #{kensakuMedSch}
		</if>
		<if test="kensakuHuniv != null">
		AND
			UPD_HST.H_UNIV = #{kensakuHuniv}
		</if>
		<if test="kensakuInsKanj != null">
		AND
			HCO_MST.INS_KANJ_SRCH LIKE '%' ||#{kensakuInsKanj}|| '%'
		</if>
		<if test="kensakuInsNo != null">
		AND
			HCP_WORK.INS_NO = #{kensakuInsNo}
		</if>

		<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(UPD_HST.UPD_MST_YMD,1,8) &gt;= #{kensakuUpdMstFrom}
		</if>
		<if test="kensakuUpdMstTo != null">
			　　AND SUBSTR(UPD_HST.UPD_MST_YMD,1,8) &lt;= #{kensakuUpdMstTo}
		</if>
	</where>
	<if test="sortId == 0">
		ORDER BY
			UPD_HST.UPD_MST_YMD, UPD_HST.REQ_ID
	</if>
	<if test="sortId == 1">
		ORDER BY
			 UPD_HST.UPD_SHA_YMD DESC, UPD_HST.REQ_ID
	</if>
	<if test="inOffset != null and inLimit != null">OFFSET #{inOffset} ROWS FETCH FIRST #{inLimit} ROWS ONLY</if>

    </select>

    <select id="searchHcpSociety" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 所属学会 -->
        SELECT
			DISTINCT
			 SOCIETY_HST.UPD_MST_YMD --マスタ更新日
			,SOCIETY_HST.DOC_NO	--医師固定コード
			,HCP_MST.DOC_KANJ	--氏名（漢字）
			,SOCIETY_HST.MEDICAL_SOCIETY_NM	--所属学会名称
			,SOCIETY_HST.MEDICAL_SOCIETY_NM_UPD_FLG	--所属学会名称更新フラグ
			,SOCIETY_HST.ADMISSION_YYYY ||'/'|| SOCIETY_HST.ADMISSION_MM ||'/'|| SOCIETY_HST.ADMISSION_DD AS ADMISSION_YMD	--入会日
			,SOCIETY_HST.ADMISSION_YMD_UPD_FLG	--入会年月日更新フラグ
			,SOCIETY_HST.QUIT_YYYY ||'/'|| SOCIETY_HST.QUIT_MM ||'/'|| SOCIETY_HST.QUIT_DD AS QUIT_YMD --脱会日
			,SOCIETY_HST.QUIT_YMD_UPD_FLG	--脱会年月日更新フラグ
			,SOCIETY_HST.POSITION_CODE	--所属役職
			,SOCIETY_HST.POSITION_CODE_UPD_FLG	--所属役職更新フラグ
			,SOCIETY_HST.SOCIETY_POSI_ST_YYYY ||'/'|| SOCIETY_HST.SOCIETY_POSI_ST_MM ||'/'|| SOCIETY_HST.SOCIETY_POSI_ST_DD	AS SOCIETY_POSI_ST_YMD --役職開始日
			,SOCIETY_HST.SOCIETY_POSI_ST_YMD_UPD_FLG	--役職開始年月日更新フラグ
			,SOCIETY_HST.SOCIETY_POSI_ED_YYYY ||'/'|| SOCIETY_HST.SOCIETY_POSI_ED_MM ||'/'|| SOCIETY_HST.SOCIETY_POSI_ED_DD	AS SOCIETY_POSI_ED_YMD --役職終了日
			,SOCIETY_HST.SOCIETY_POSI_ED_YMD_UPD_FLG	--役職終了年月日更新フラグ
			,SOCIETY_HST.COACHING_ACQUISI_YYYY ||'/'|| SOCIETY_HST.COACHING_ACQUISI_MM ||'/'|| SOCIETY_HST.COACHING_ACQUISI_DD AS COACHING_ACQUISI_YMD	--指導医取得日
			,SOCIETY_HST.COACHING_ACQUISI_YMD_UPD_FLG	--指導医取得年月日更新フラグ
			,SOCIETY_HST.COACHING_ST_YYYY  ||'/'|| SOCIETY_HST.COACHING_ST_MM  ||'/'|| SOCIETY_HST.COACHING_ST_DD AS COACHING_ST_YMD	--指導医開始日
			,SOCIETY_HST.COACHING_ST_YMD_UPD_FLG	--指導医開始年月日更新フラグ
			,SOCIETY_HST.COACHING_ED_YYYY  ||'/'|| SOCIETY_HST.COACHING_ED_MM  ||'/'|| SOCIETY_HST.COACHING_ED_DD AS COACHING_ED_YMD	--指導医終了日
			,SOCIETY_HST.COACHING_ED_YMD_UPD_FLG	--指導医終了年月日更新フラグ
			,SOCIETY_HST.CERTIFY_ST_YYYY  ||'/'|| SOCIETY_HST.CERTIFY_ST_MM   ||'/'|| SOCIETY_HST.CERTIFY_ST_DD	AS CERTIFY_ST_YMD --認定医開始年月日
			,SOCIETY_HST.CERTIFY_ST_YMD_UPD_FLG	--認定医開始年月日更新フラグ
			,SOCIETY_HST.CERTIFY_ED_YYYY ||'/'|| SOCIETY_HST.CERTIFY_ED_MM ||'/'|| SOCIETY_HST.CERTIFY_ED_DD AS CERTIFY_ED_YMD	--認定医終了年月日
			,SOCIETY_HST.CERTIFY_ED_YMD_UPD_FLG	--認定医終了年月日更新フラグ
			,SOCIETY_HST.ADVISING_DOCTOR	--所属学会指導医区分
			,SOCIETY_HST.ADVISING_DOCTOR_UPD_FLG	--所属学会指導医区分更新フラグ
			,SOCIETY_HST.CERTIFYING_PHYSICIAN	--所属学会認定医区分
			,SOCIETY_HST.CERTIFYING_PHYSICIAN_UPD_FLG	--所属学会認定医区分更新フラグ
			,SOCIETY_HST.REQ_SHZ	--申請者所属
			,SOCIETY_HST.REQ_JGI_NAME	--申請者氏名
			,SOCIETY_HST.APR_SHZ	--承認者所属
			,SOCIETY_HST.APR_SHA_ID	--承認者氏名
			,SOCIETY_HST.REQ_CHL	--申請チャネル
			,SOCIETY_HST.REQ_ID	--申請ID
		FROM
			T_RDM_HCP_SOCIETY_HST SOCIETY_HST --医師_所属学会_変更履歴
		LEFT JOIN
			M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
		ON
			DOC_TRT.DOC_NO = SOCIETY_HST.DOC_NO --医師固定C
		LEFT JOIN
			M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
		ON
			SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
		LEFT JOIN
			M_RDM_HCP_MST HCP_MST --医師_基本情報
		ON
			HCP_MST.DOC_NO = SOCIETY_HST.DOC_NO --医師固定C
		LEFT JOIN
			M_RDM_HCO_MST HCO_MST --施設_基本情報
		ON
			HCO_MST.INS_NO = DOC_TRT.INS_NO --施設固定コード
		<where>
			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					SOCIETY_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					SOCIETY_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					SOCIETY_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					SOCIETY_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					SOCIETY_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					SOCIETY_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				SOCIETY_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				DOC_TRT.INS_NO = #{kensakuInsNo}
			</if>

			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(SOCIETY_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(SOCIETY_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				SOCIETY_HST.UPD_MST_YMD, SOCIETY_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 SOCIETY_HST.UPD_SHA_YMD DESC, SOCIETY_HST.REQ_ID
		</if>
		<if test="sortId == 2">
			ORDER BY
				 SOCIETY_HST.REQ_ID
		</if>
		<if test="sortId == 3">
			ORDER BY
				 SOCIETY_HST.REQ_ID DESC
		</if>
		<if test="inOffset != null and inLimit != null">OFFSET #{inOffset} ROWS FETCH FIRST #{inLimit} ROWS ONLY</if>
    </select>

    <select id="searchPublicHst" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 公的機関 -->
        SELECT
        	DISTINCT
			 PUBLIC_HST.UPD_MST_YMD	--マスタ更新日
			,PUBLIC_HST.DOC_NO	--医師固定コード
			,HCP_MST.DOC_KANJ	--氏名（漢字）
			,PUBLIC_HST.CLASS_CATEGORY	--分類区分
			,PUBLIC_HST.CLASS_CATEGORY_UPD_FLG	--分類区分更新フラグ
			,PUBLIC_HST.PUB_INSTITUTION	--公的機関
			,PUBLIC_HST.PUB_INSTITUTION_UPD_FLG	--公的機関更新フラグ
			,PUBLIC_HST.PUB_INST_ST_YYYY ||'/'|| PUBLIC_HST.PUB_INST_ST_MM ||'/'|| PUBLIC_HST.PUB_INST_ST_DD AS PUB_INST_ST_YMD	--公的機関開始年月日
			,PUBLIC_HST.PUB_INST_ST_YMD_UPD_FLG	--公的機関開始年月日更新フラグ
			,PUBLIC_HST.PUB_INST_ED_YYYY  ||'/'|| PUBLIC_HST.PUB_INST_ED_MM  ||'/'|| PUBLIC_HST.PUB_INST_ED_DD AS PUB_INST_ED_YMD	--公的機関終了年月日
			,PUBLIC_HST.PUB_INST_ED_YMD_UPD_FLG	--公的機関終了年月日更新フラグ
			,PUBLIC_HST.PUB_INST_POSITION	--公的機関役職コード
			,PUBLIC_HST.PUB_INST_POSITION_UPD_FLG	---公的機関役職コード更新フラグ
			,PUBLIC_HST.PUB_INSTPOS_ST_YYYY ||'/'|| PUBLIC_HST.PUB_INSTPOS_ST_MM ||'/'|| PUBLIC_HST.PUB_INSTPOS_ST_DD AS PUB_INSTPOS_ST_YMD	--公的機関役職開始年月日
			,PUBLIC_HST.PUB_INSTPOS_ST_YMD_UPD_FLG	--公的機関役職開始年月日更新フラグ
			,PUBLIC_HST.PUB_INSTPOS_ED_YYYY  ||'/'|| PUBLIC_HST.PUB_INSTPOS_ED_MM  ||'/'|| PUBLIC_HST.PUB_INSTPOS_ED_DD AS PUB_INSTPOS_ED_YMD	--公的機関役職終了年月日
			,PUBLIC_HST.PUB_INSTPOS_ED_YMD_UPD_FLG	--公的機関役職終了年月日更新フラグ
			,PUBLIC_HST.REQ_SHZ	--申請者所属
			,PUBLIC_HST.REQ_JGI_NAME	--申請者氏名
			,PUBLIC_HST.APR_SHZ	--承認者所属
			,PUBLIC_HST.APR_SHA_ID	--承認者氏名
			,PUBLIC_HST.REQ_CHL	--申請チャネル
			,PUBLIC_HST.REQ_ID	--申請ID
		FROM
			T_RDM_HCP_PUBLIC_HST PUBLIC_HST	--医師_公的機関_変更履歴
		LEFT JOIN
			M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT	--RDM用医師担当者情報
		ON
			DOC_TRT.DOC_NO = PUBLIC_HST.DOC_NO --医師固定コード
		LEFT JOIN
			M_RDM_JGI_SOS_MST SOS_MST	--RDM用組織従業員情報
		ON
			SOS_MST.JGI_NO = DOC_TRT.JGI_NO	--従業員番号
		LEFT JOIN
			M_RDM_HCP_MST HCP_MST --医師_基本情報
		ON
			HCP_MST.DOC_NO = PUBLIC_HST.DOC_NO --医師固定コード
		LEFT JOIN
			M_RDM_HCP_PUB_INSTITUTION PUB_INSTITUTION	--医師_公的機関マスタ
		ON
			PUB_INSTITUTION.PUB_INSTITUTION_CD = PUBLIC_HST.PUB_INSTITUTION	--公的機関コード・公的機関
		LEFT JOIN
			M_RDM_HCO_MST HCO_MST --施設_基本情報
		ON
			HCO_MST.INS_NO = DOC_TRT.INS_NO --施設固定コード
		<where>

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					PUBLIC_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					PUBLIC_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					PUBLIC_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					PUBLIC_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					PUBLIC_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					PUBLIC_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				PUBLIC_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				DOC_TRT.INS_NO = #{kensakuInsNo}
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(PUBLIC_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(PUBLIC_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				PUBLIC_HST.UPD_MST_YMD, PUBLIC_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 PUBLIC_HST.UPD_SHA_YMD DESC, PUBLIC_HST.REQ_ID
		</if>
		<if test="sortId == 2">
			ORDER BY
				 PUBLIC_HST.REQ_ID
		</if>
		<if test="sortId == 3">
			ORDER BY
				 PUBLIC_HST.REQ_ID DESC
		</if>
		<if test="inOffset != null and inLimit != null">OFFSET #{inOffset} ROWS FETCH FIRST #{inLimit} ROWS ONLY</if>
    </select>

    <select id="searchKmuHst1" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'31'(医師新規作成),'41'(医師勤務先追加)-->
	SELECT
			DISTINCT
			 KMU_HST.UPD_MST_YMD --マスタ更新日
			,KMU_HST.DOC_NO	--医師固定コード
			,HCP_MST.DOC_KANJ	--氏名（漢字）
			,REQ_KNR.REQ_TYPE	--申請区分
			,KMU_HST.INS_NO_SK	--施設固定コード(異動先)
			,KMU_HST.JOB_FORM_AF	--勤務形態(異動先)
			,KMU_HST.DEPT_KANJI_AF	--所属部科名（漢字）(異動先)
			,KMU_HST.TITLE_CODE_AF	--役職コード(異動先)
			,KMU_HST.UNIV_POS_CODE_AF	--大学職位コード(異動先)
			,KMU_HST.DCC_TYPE_AF	--薬審メンバー区分(異動先)
			,KMU_HST.REQ_SHZ	--申請者所属
			,KMU_HST.REQ_JGI_NAME	--申請者氏名
			,KMU_HST.APR_SHZ	--承認者所属
			,KMU_HST.APR_SHA_ID	--承認者氏名
			,KMU_HST.REQ_CHL	--申請チャネル
			,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		 --申請区分が'31'(医師新規作成),'41'(医師勤務先追加)

		<where>
			AND
				(REQ_KNR.REQ_TYPE = '31' OR REQ_KNR.REQ_TYPE = '41')

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				KMU_HST.UPD_MST_YMD, KMU_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 KMU_HST.UPD_SHA_YMD DESC, KMU_HST.REQ_ID
		</if>
    </select>

    <select id="searchKmuHst2" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'51'(勤務先情報更新)、'42'(医療機関への異動)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_SK	--施設固定コード(異動先)
		,KMU_HST.JOB_FORM_AF	--勤務形態(異動先)
		,KMU_HST.DEPT_KANJI_AF	--所属部科名（漢字）(異動先)
		,KMU_HST.TITLE_CODE_AF	--役職コード(異動先)
		,KMU_HST.UNIV_POS_CODE_AF	--大学職位コード(異動先)
		,KMU_HST.DCC_TYPE_AF	--薬審メンバー区分(異動先)
		,KMU_HST.INS_NO_SK_UPD_FLG	--施設固定コード(異動先)更新フラグ
		,KMU_HST.JOB_FORM_AF_UPD_FLG --勤務形態(異動先)更新フラグ
		,KMU_HST.DEPT_KANJI_AF_UPD_FLG --所属部科名（漢字）(異動先)更新フラグ
		,KMU_HST.TITLE_CODE_AF_UPD_FLG --役職コード(異動先)更新フラグ
		,KMU_HST.UNIV_POS_CODE_AF_UPD_FLG	--大学職位コード(異動先)更新フラグ
		,KMU_HST.DCC_TYPE_AF_UPD_FLG --薬審メンバー区分(異動先)更新フラグ
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード

		<where>
			AND
				(REQ_KNR.REQ_TYPE = '51' OR REQ_KNR.REQ_TYPE = '42')

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				KMU_HST.UPD_MST_YMD, KMU_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 KMU_HST.UPD_SHA_YMD DESC, KMU_HST.REQ_ID
		</if>
    </select>

    <select id="searchKmuHst3" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'43'(医療機関以外への異動)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元))
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '43'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				KMU_HST.UPD_MST_YMD, KMU_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 KMU_HST.UPD_SHA_YMD DESC, KMU_HST.REQ_ID
		</if>
    </select>

    <select id="searchKmuHst4" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'44'(医師勤務先削除)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '44'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				KMU_HST.UPD_MST_YMD, KMU_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 KMU_HST.UPD_SHA_YMD DESC, KMU_HST.REQ_ID
		</if>
    </select>

    <select id="searchKmuHst5" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'33'(医師削除)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '33'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				KMU_HST.UPD_MST_YMD, KMU_HST.REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 KMU_HST.UPD_SHA_YMD DESC, KMU_HST.REQ_ID
		</if>
    </select>


    <select id="searchKmuHst" parameterType="jp.co.takeda.rdm.entity.join.MRdmHcpUpdHstListEntity" resultMap="MRdmHcpUpdHstEntiryResultMap">
    <!-- 申請区分が'31'(医師新規作成),'41'(医師勤務先追加)-->
	SELECT
			DISTINCT
			 KMU_HST.UPD_MST_YMD --マスタ更新日
			,KMU_HST.DOC_NO	--医師固定コード
			,HCP_MST.DOC_KANJ	--氏名（漢字）
			,REQ_KNR.REQ_TYPE	--申請区分
			,KMU_HST.INS_NO_SK	--施設固定コード(異動先)
			,KMU_HST.JOB_FORM_AF	--勤務形態(異動先)
			,KMU_HST.DEPT_KANJI_AF	--所属部科名（漢字）(異動先)
			,KMU_HST.TITLE_CODE_AF	--役職コード(異動先)
			,KMU_HST.UNIV_POS_CODE_AF	--大学職位コード(異動先)
			,KMU_HST.DCC_TYPE_AF	--薬審メンバー区分(異動先)
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,null
			,KMU_HST.REQ_SHZ	--申請者所属
			,KMU_HST.REQ_JGI_NAME	--申請者氏名
			,KMU_HST.APR_SHZ	--承認者所属
			,KMU_HST.APR_SHA_ID	--承認者氏名
			,KMU_HST.REQ_CHL	--申請チャネル
			,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		 --申請区分が'31'(医師新規作成),'41'(医師勤務先追加)

		<where>
			AND
				(REQ_KNR.REQ_TYPE = '31' OR REQ_KNR.REQ_TYPE = '41')

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>

	UNION ALL

    <!-- 申請区分が'51'(勤務先情報更新)、'42'(医療機関への異動)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_SK	--施設固定コード(異動先)
		,KMU_HST.JOB_FORM_AF	--勤務形態(異動先)
		,KMU_HST.DEPT_KANJI_AF	--所属部科名（漢字）(異動先)
		,KMU_HST.TITLE_CODE_AF	--役職コード(異動先)
		,KMU_HST.UNIV_POS_CODE_AF	--大学職位コード(異動先)
		,KMU_HST.DCC_TYPE_AF	--薬審メンバー区分(異動先)
		,KMU_HST.INS_NO_SK_UPD_FLG	--施設固定コード(異動先)更新フラグ
		,KMU_HST.JOB_FORM_AF_UPD_FLG --勤務形態(異動先)更新フラグ
		,KMU_HST.DEPT_KANJI_AF_UPD_FLG --所属部科名（漢字）(異動先)更新フラグ
		,KMU_HST.TITLE_CODE_AF_UPD_FLG --役職コード(異動先)更新フラグ
		,KMU_HST.UNIV_POS_CODE_AF_UPD_FLG	--大学職位コード(異動先)更新フラグ
		,KMU_HST.DCC_TYPE_AF_UPD_FLG --薬審メンバー区分(異動先)更新フラグ
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード

		<where>
			AND
				(REQ_KNR.REQ_TYPE = '51' OR REQ_KNR.REQ_TYPE = '42')

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>

	UNION ALL
    <!-- 申請区分が'43'(医療機関以外への異動)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元))
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '43'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>

	UNION ALL
    <!-- 申請区分が'44'(医師勤務先削除)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '44'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>

	UNION ALL
    <!-- 申請区分が'33'(医師削除)-->
	SELECT
		DISTINCT
		 KMU_HST.UPD_MST_YMD --マスタ更新日
		,KMU_HST.DOC_NO	--医師固定コード
		,HCP_MST.DOC_KANJ	--氏名（漢字）
		,REQ_KNR.REQ_TYPE	--申請区分
		,KMU_HST.INS_NO_MT	--施設固定コード(異動元)
		,KMU_HST.JOB_FORM_BF	--勤務形態(異動元)
		,KMU_HST.DEPT_KANJI_BF	--所属部科名（漢字）(異動元)
		,KMU_HST.TITLE_CODE_BF	--役職コード(異動元)
		,KMU_HST.UNIV_POS_CODE_BF	--大学職位コード(異動元)
		,KMU_HST.DCC_TYPE_BF	--薬審メンバー区分(異動元)
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,null
		,KMU_HST.REQ_SHZ	--申請者所属
		,KMU_HST.REQ_JGI_NAME	--申請者氏名
		,KMU_HST.APR_SHZ	--承認者所属
		,KMU_HST.APR_SHA_ID	--承認者氏名
		,KMU_HST.REQ_CHL	--申請チャネル
		,KMU_HST.REQ_ID	--申請ID
	FROM
		T_RDM_HCP_KMU_HST KMU_HST --勤務先_変更履歴
	LEFT JOIN
		T_RDM_REQ_KNR REQ_KNR --申請管理
	ON
		REQ_KNR.REQ_ID = KMU_HST.REQ_ID --申請ID
	LEFT JOIN
		M_RDM_JKR_MR_INS_DOC_TRT DOC_TRT --RDM用医師担当者情報
	ON
		DOC_TRT.DOC_NO = KMU_HST.REQ_ID --医師固定コード
	LEFT JOIN
		M_RDM_JGI_SOS_MST SOS_MST --RDM用組織従業員情報
	ON
		SOS_MST.JGI_NO = DOC_TRT.JGI_NO --従業員番号
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_SK--施設_基本情報(異動先)
	ON
		HCO_MST_SK.INS_NO = KMU_HST.INS_NO_SK --施設固定コード・施設固定コード(異動先)
	LEFT JOIN
		M_RDM_HCO_MST HCO_MST_MT --施設_基本情報(異動元)
	ON
		HCO_MST_MT.INS_NO = KMU_HST.INS_NO_MT --施設固定コード・施設固定コード(異動元)
	LEFT JOIN
		M_RDM_HCP_MST HCP_MST --医師_基本情報
	ON
		HCP_MST.DOC_NO = KMU_HST.DOC_NO --医師固定コード
		<where>
			AND
				REQ_KNR.REQ_TYPE = '33'

			<if test="jokenSetCd == 0">
				<if test="mrJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrTrtCd != null">
				AND
					DOC_TRT.TRT_CD = #{mrTrtCd}
				</if>
				<if test="mrJgiNo != 0">
				AND
					KMU_HST.REQ_JGI_NO = #{mrJgiNo}
				</if>
				<if test="mrDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE = #{mrDistCode}
				</if>
				<if test="mrBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{mrBrCode}
				</if>
			</if>

			<if test="jokenSetCd == 1">
				<if test="kensakuTantouDistCode != null">
				AND
					SOS_MST.DIST_CODE = #{kensakuTantouDistCode}
				</if>
				<if test="kensakuSTantouBrCode != null">
				AND
					SOS_MST.BR_CODE = #{kensakuSTantouBrCode}
				</if>
				<if test="kensakuJgiNo != 0">
				AND
					DOC_TRT.JGI_NO = #{kensakuJgiNo}
				</if>
				<if test="kensakuShinseiBrCode != null">
				AND
					KMU_HST.REQ_BR_CODE = #{kensakuShinseiBrCode}
				</if>
				<if test="kensakuShinseiDistCode != null">
				AND
					KMU_HST.REQ_DIST_CODE  = #{kensakuShinseiDistCode}
				</if>
				<if test="kensakuReqJgiName != null">
				AND
					KMU_HST.REQ_JGI_NAME LIKE '%' || #{kensakuReqJgiName} || '%'
				</if>
			</if>

			<if test="kensakuDocKanj != null">
			AND
				HCP_MST.DOC_KANJ LIKE '%' ||#{kensakuDocKanj}|| '%'
			</if>
			<if test="kensakuDocKana != null">
			AND
				HCP_MST.DOC_KANA LIKE '%' ||#{kensakuDocKana}|| '%'
			</if>
			<if test="kensakuDocNo != null">
			AND
				KMU_HST.DOC_NO = #{kensakuDocNo}
			</if>
			<if test="kensakuUltDocNo != null">
			AND
				HCP_MST.ULT_DOC_NO = #{kensakuUltDocNo}
			</if>
			<if test="kensakuDocType != null">
			AND
				HCP_MST.DOC_TYPE = #{kensakuDocType}
			</if>
			<if test="kensakuDocAttribute != null">
			AND
				HCP_MST.DOC_ATTRIBUTE = #{kensakuDocAttribute}
			</if>
			<if test="kensakuGradYear != null">
			AND
				HCP_MST.GRAD_YEAR = #{kensakuGradYear}
			</if>
			<if test="kensakuMedSch != null">
			AND
				HCP_MST.MED_SCH = #{kensakuMedSch}
			</if>
			<if test="kensakuHuniv != null">
			AND
				HCP_MST.H_UNIV = #{kensakuHuniv}
			</if>
			<if test="kensakuInsKanj != null">
			AND
				HCO_MST.INS_KANJ_SRCH = #{kensakuInsKanj}
			</if>
			<if test="kensakuInsNo != null">
			AND
				(KMU_HST.INS_NO_MT = #{kensakuInsNo}
			OR
				KMU_HST.INS_NO_SK = #{kensakuInsNo})
			</if>
			<if test="kensakuUpdMstFrom != null">
	  		  AND SUBSTR(KMU_HST.UPD_MST_YMD,　1,8) &gt;= #{kensakuUpdMstFrom}
			</if>
			<if test="kensakuUpdMstTo != null">
				　　AND SUBSTR(KMU_HST.UPD_MST_YMD, 1, 8) &lt;= #{kensakuUpdMstTo}
			</if>
		</where>
		<if test="sortId == 0">
			ORDER BY
				UPD_MST_YMD, REQ_ID
		</if>
		<if test="sortId == 1">
			ORDER BY
				 UPD_MST_YMD DESC, REQ_ID
		</if>
		<if test="inOffset != null and inLimit != null">OFFSET #{inOffset} ROWS FETCH FIRST #{inLimit} ROWS ONLY</if>
    </select>
</mapper>
